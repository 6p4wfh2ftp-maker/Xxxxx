<!doctype html>
<html lang="ro">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fațadă – Randare AI</title>

<style>
body{margin:0;font-family:Arial;background:#0b0c10;color:#e9eef7}
.wrap{max-width:1100px;margin:20px auto;padding:0 14px;display:grid;grid-template-columns:380px 1fr;gap:14px}
.card{background:#11131a;border:1px solid #222738;border-radius:14px;padding:14px}
h3{margin:0 0 10px}
input,textarea,button{width:100%;padding:10px;border-radius:10px;border:1px solid #222738;background:#0f1118;color:#e9eef7}
textarea{min-height:90px}
button{background:#3b82f6;border:none;font-weight:700;cursor:pointer}
.status{margin-top:10px;color:#aab4c3}
.result img{max-width:100%;border-radius:12px;border:1px solid #222738}
.small{font-size:12px;color:#aab4c3}
</style>
</head>

<body>

<div class="wrap">
  <div class="card">
    <h3>1️⃣ Poză fațadă</h3>
    <input type="file" id="file" accept="image/*">

    <h3 style="margin-top:14px">2️⃣ Micro-corecții (opțional)</h3>
    <textarea id="micro" placeholder="Ex: fără coloane pe laterale, ancadramente simple..."></textarea>

    <button id="run" style="margin-top:14px">Randare AI</button>
    <div class="status" id="status">Gata.</div>

    <div class="small">
      Promptul general este automat și nu poate fi modificat.<br>
      Acest câmp este doar pentru ajustări punctuale.
    </div>
  </div>

  <div class="card result" id="result">
    <div class="small">Rezultatul apare aici.</div>
  </div>
</div>

<script>
const WORKER_URL = "https://fatada-render.6p4wfh2ftp.workers.dev/";

const MASTER_PROMPT = `
EDIT THE PROVIDED IMAGE ONLY.

REFERENCE IMAGE:
The uploaded image represents a REAL, EXISTING residential building.

ABSOLUTE CONSTRAINTS:
- Preserve volume, floors, roof, slabs, pillars, windows, doors
- No structural or architectural changes
- No redesign, no new building

ALLOWED:
- Applied decorative facade elements only
- Flat / semi-flat, realistic, buildable

STYLE:
Classical / Neoclassical
Clean, realistic, residential

FORBIDDEN:
- New balconies, roofs, volumes
- Changed windows or proportions

FINAL:
Same building, unchanged structure, only decorative profiles applied.
`.trim();

document.getElementById("run").onclick = async () => {
  const file = document.getElementById("file").files[0];
  const micro = document.getElementById("micro").value.trim();
  const status = document.getElementById("status");
  const result = document.getElementById("result");

  if(!file){ alert("Încarcă o poză"); return; }

  const prompt = micro
    ? MASTER_PROMPT + "\n\nPROJECT-SPECIFIC ADJUSTMENTS:\n" + micro
    : MASTER_PROMPT;

  const fd = new FormData();
  fd.append("image", file, "input.jpg");
  fd.append("prompt", prompt);

  status.textContent = "Se generează...";
  result.innerHTML = "<div class='small'>Se generează...</div>";

  const r = await fetch(WORKER_URL,{method:"POST",body:fd});
  if(!r.ok){
    const t = await r.text();
    status.textContent = "Eroare: " + r.status + " / " + t;
    return;
  }

  const blob = await r.blob();
  const img = document.createElement("img");
  img.src = URL.createObjectURL(blob);
  result.innerHTML = "";
  result.appendChild(img);
  status.textContent = "Gata ✅";
};
</script>

</body>
</html>
